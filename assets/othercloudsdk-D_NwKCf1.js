import{E as Ye}from"./vendor-SK0junsM.js";import{r as Qe}from"./utils-B37zfsk1.js";var De=function(){var s=function(r,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var t in o)o.hasOwnProperty(t)&&(i[t]=o[t])},s(r,e)};return function(r,e){s(r,e);function i(){this.constructor=r}r.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),A;(function(s){s.InvalidFile="InvalidFile",s.InvalidToken="InvalidToken",s.InvalidMetadata="InvalidMetadata",s.InvalidChunkSize="InvalidChunkSize",s.InvalidCustomVars="InvalidCustomVars",s.NotAvailableUploadHost="NotAvailableUploadHost",s.ReadCacheFailed="ReadCacheFailed",s.InvalidCacheData="InvalidCacheData",s.WriteCacheFailed="WriteCacheFailed",s.RemoveCacheFailed="RemoveCacheFailed",s.GetCanvasContextFailed="GetCanvasContextFailed",s.UnsupportedFileType="UnsupportedFileType",s.FileReaderReadFailed="FileReaderReadFailed",s.NotAvailableXMLHttpRequest="NotAvailableXMLHttpRequest",s.InvalidProgressEventTarget="InvalidProgressEventTarget",s.RequestError="RequestError"})(A||(A={}));var C=function(){function s(r,e){this.name=r,this.message=e,this.stack=new Error().stack}return s}(),G=function(s){De(r,s);function r(e,i,o,t){var l=s.call(this,A.RequestError,o)||this;return l.code=e,l.reqId=i,l.isRequestError=!0,l.data=t,l}return r}(C),et=function(s){De(r,s);function r(e,i){return i===void 0&&(i=""),s.call(this,0,i,e)||this}return r}(G),tt=function(){function s(r,e){this.runTask=r,this.limit=e,this.aborted=!1,this.queue=[],this.processing=[]}return s.prototype.enqueue=function(r){var e=this;return new Promise(function(i,o){e.queue.push({task:r,resolve:i,reject:o}),e.check()})},s.prototype.run=function(r){var e=this;this.queue=this.queue.filter(function(i){return i!==r}),this.processing.push(r),this.runTask(r.task).then(function(){e.processing=e.processing.filter(function(i){return i!==r}),r.resolve(),e.check()},function(i){return r.reject(i)})},s.prototype.check=function(){var r=this;if(!this.aborted){var e=this.processing.length,i=this.limit-e;this.queue.slice(0,i).forEach(function(o){r.run(o)})}},s.prototype.abort=function(){this.queue=[],this.aborted=!0},s}(),rt=function(){var s=function(r,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var t in o)o.hasOwnProperty(t)&&(i[t]=o[t])},s(r,e)};return function(r,e){s(r,e);function i(){this.constructor=r}r.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),$=function(){return $=Object.assign||function(s){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},$.apply(this,arguments)},nt=function(){function s(){this.closed=!1}return s.prototype.unsubscribe=function(){this.closed||(this.closed=!0,this._unsubscribe&&this._unsubscribe())},s.prototype.add=function(r){this._unsubscribe=r},s}(),it=function(s){rt(r,s);function r(e,i,o){var t=s.call(this)||this;return t.isStopped=!1,e&&typeof e=="object"?t.destination=e:t.destination=$($($({},e&&{next:e}),i&&{error:i}),o&&{complete:o}),t}return r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,s.prototype.unsubscribe.call(this))},r.prototype.next=function(e){!this.isStopped&&this.destination.next&&this.destination.next(e)},r.prototype.error=function(e){!this.isStopped&&this.destination.error&&(this.isStopped=!0,this.destination.error(e))},r.prototype.complete=function(e){!this.isStopped&&this.destination.complete&&(this.isStopped=!0,this.destination.complete(e))},r}(nt),ot=function(){function s(r){this._subscribe=r}return s.prototype.subscribe=function(r,e,i){var o=new it(r,e,i);return o.add(this._subscribe(o)),o},s}();function at(s){if(s===null||typeof s>"u")return"";var r=s+"",e="",i,o,t=0;i=o=0,t=r.length;for(var l=0;l<t;l++){var c=r.charCodeAt(l),w=null;if(c<128)o++;else if(c>127&&c<2048)w=String.fromCharCode(c>>6|192,c&63|128);else if((c&63488^55296)>0)w=String.fromCharCode(c>>12|224,c>>6&63|128,c&63|128);else{if((c&64512^55296)>0)throw new RangeError("Unmatched trail surrogate at "+l);var n=r.charCodeAt(++l);if((n&64512^56320)>0)throw new RangeError("Unmatched lead surrogate at "+(l-1));c=((c&1023)<<10)+(n&1023)+65536,w=String.fromCharCode(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}w!==null&&(o>i&&(e+=r.slice(i,o)),e+=w,i=o=l+1)}return o>i&&(e+=r.slice(i,t)),e}function st(s){var r=[],e=0,i=0,o=0;for(s+="";e<s.length;){i=s.charCodeAt(e)&255,o=0,i<=191?(i=i&127,o=1):i<=223?(i=i&31,o=2):i<=239?(i=i&15,o=3):(i=i&7,o=4);for(var t=1;t<o;++t)i=i<<6|s.charCodeAt(t+e)&63;o===4?(i-=65536,r.push(String.fromCharCode(55296|i>>10&1023)),r.push(String.fromCharCode(56320|i&1023))):r.push(String.fromCharCode(i)),e+=o}return r.join("")}function ut(s){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e,i,o,t,l,c,w,n,a=0,d=0,p="",g=[];if(!s)return s;s=at(s+"");do e=s.charCodeAt(a++),i=s.charCodeAt(a++),o=s.charCodeAt(a++),n=e<<16|i<<8|o,t=n>>18&63,l=n>>12&63,c=n>>6&63,w=n&63,g[d++]=r.charAt(t)+r.charAt(l)+r.charAt(c)+r.charAt(w);while(a<s.length);switch(p=g.join(""),s.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"=";break}return p}function ft(s){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e,i,o,t,l,c,w,n,a=0,d=0,p="",g=[];if(!s)return s;s+="";do t=r.indexOf(s.charAt(a++)),l=r.indexOf(s.charAt(a++)),c=r.indexOf(s.charAt(a++)),w=r.indexOf(s.charAt(a++)),n=t<<18|l<<12|c<<6|w,e=n>>16&255,i=n>>8&255,o=n&255,c===64?g[d++]=String.fromCharCode(e):w===64?g[d++]=String.fromCharCode(e,i):g[d++]=String.fromCharCode(e,i,o);while(a<s.length);return p=g.join(""),st(p)}function He(s){return s=ut(s),s.replace(/\//g,"_").replace(/\+/g,"-")}function ct(s){return s=s.replace(/_/g,"/").replace(/-/g,"+"),ft(s)}var Q={exports:{}},ye;function lt(){return ye||(ye=1,function(s,r){(function(e){s.exports=e()})(function(e){var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function o(m,y){var u=m[0],f=m[1],v=m[2],h=m[3];u+=(f&v|~f&h)+y[0]-680876936|0,u=(u<<7|u>>>25)+f|0,h+=(u&f|~u&v)+y[1]-389564586|0,h=(h<<12|h>>>20)+u|0,v+=(h&u|~h&f)+y[2]+606105819|0,v=(v<<17|v>>>15)+h|0,f+=(v&h|~v&u)+y[3]-1044525330|0,f=(f<<22|f>>>10)+v|0,u+=(f&v|~f&h)+y[4]-176418897|0,u=(u<<7|u>>>25)+f|0,h+=(u&f|~u&v)+y[5]+1200080426|0,h=(h<<12|h>>>20)+u|0,v+=(h&u|~h&f)+y[6]-1473231341|0,v=(v<<17|v>>>15)+h|0,f+=(v&h|~v&u)+y[7]-45705983|0,f=(f<<22|f>>>10)+v|0,u+=(f&v|~f&h)+y[8]+1770035416|0,u=(u<<7|u>>>25)+f|0,h+=(u&f|~u&v)+y[9]-1958414417|0,h=(h<<12|h>>>20)+u|0,v+=(h&u|~h&f)+y[10]-42063|0,v=(v<<17|v>>>15)+h|0,f+=(v&h|~v&u)+y[11]-1990404162|0,f=(f<<22|f>>>10)+v|0,u+=(f&v|~f&h)+y[12]+1804603682|0,u=(u<<7|u>>>25)+f|0,h+=(u&f|~u&v)+y[13]-40341101|0,h=(h<<12|h>>>20)+u|0,v+=(h&u|~h&f)+y[14]-1502002290|0,v=(v<<17|v>>>15)+h|0,f+=(v&h|~v&u)+y[15]+1236535329|0,f=(f<<22|f>>>10)+v|0,u+=(f&h|v&~h)+y[1]-165796510|0,u=(u<<5|u>>>27)+f|0,h+=(u&v|f&~v)+y[6]-1069501632|0,h=(h<<9|h>>>23)+u|0,v+=(h&f|u&~f)+y[11]+643717713|0,v=(v<<14|v>>>18)+h|0,f+=(v&u|h&~u)+y[0]-373897302|0,f=(f<<20|f>>>12)+v|0,u+=(f&h|v&~h)+y[5]-701558691|0,u=(u<<5|u>>>27)+f|0,h+=(u&v|f&~v)+y[10]+38016083|0,h=(h<<9|h>>>23)+u|0,v+=(h&f|u&~f)+y[15]-660478335|0,v=(v<<14|v>>>18)+h|0,f+=(v&u|h&~u)+y[4]-405537848|0,f=(f<<20|f>>>12)+v|0,u+=(f&h|v&~h)+y[9]+568446438|0,u=(u<<5|u>>>27)+f|0,h+=(u&v|f&~v)+y[14]-1019803690|0,h=(h<<9|h>>>23)+u|0,v+=(h&f|u&~f)+y[3]-187363961|0,v=(v<<14|v>>>18)+h|0,f+=(v&u|h&~u)+y[8]+1163531501|0,f=(f<<20|f>>>12)+v|0,u+=(f&h|v&~h)+y[13]-1444681467|0,u=(u<<5|u>>>27)+f|0,h+=(u&v|f&~v)+y[2]-51403784|0,h=(h<<9|h>>>23)+u|0,v+=(h&f|u&~f)+y[7]+1735328473|0,v=(v<<14|v>>>18)+h|0,f+=(v&u|h&~u)+y[12]-1926607734|0,f=(f<<20|f>>>12)+v|0,u+=(f^v^h)+y[5]-378558|0,u=(u<<4|u>>>28)+f|0,h+=(u^f^v)+y[8]-2022574463|0,h=(h<<11|h>>>21)+u|0,v+=(h^u^f)+y[11]+1839030562|0,v=(v<<16|v>>>16)+h|0,f+=(v^h^u)+y[14]-35309556|0,f=(f<<23|f>>>9)+v|0,u+=(f^v^h)+y[1]-1530992060|0,u=(u<<4|u>>>28)+f|0,h+=(u^f^v)+y[4]+1272893353|0,h=(h<<11|h>>>21)+u|0,v+=(h^u^f)+y[7]-155497632|0,v=(v<<16|v>>>16)+h|0,f+=(v^h^u)+y[10]-1094730640|0,f=(f<<23|f>>>9)+v|0,u+=(f^v^h)+y[13]+681279174|0,u=(u<<4|u>>>28)+f|0,h+=(u^f^v)+y[0]-358537222|0,h=(h<<11|h>>>21)+u|0,v+=(h^u^f)+y[3]-722521979|0,v=(v<<16|v>>>16)+h|0,f+=(v^h^u)+y[6]+76029189|0,f=(f<<23|f>>>9)+v|0,u+=(f^v^h)+y[9]-640364487|0,u=(u<<4|u>>>28)+f|0,h+=(u^f^v)+y[12]-421815835|0,h=(h<<11|h>>>21)+u|0,v+=(h^u^f)+y[15]+530742520|0,v=(v<<16|v>>>16)+h|0,f+=(v^h^u)+y[2]-995338651|0,f=(f<<23|f>>>9)+v|0,u+=(v^(f|~h))+y[0]-198630844|0,u=(u<<6|u>>>26)+f|0,h+=(f^(u|~v))+y[7]+1126891415|0,h=(h<<10|h>>>22)+u|0,v+=(u^(h|~f))+y[14]-1416354905|0,v=(v<<15|v>>>17)+h|0,f+=(h^(v|~u))+y[5]-57434055|0,f=(f<<21|f>>>11)+v|0,u+=(v^(f|~h))+y[12]+1700485571|0,u=(u<<6|u>>>26)+f|0,h+=(f^(u|~v))+y[3]-1894986606|0,h=(h<<10|h>>>22)+u|0,v+=(u^(h|~f))+y[10]-1051523|0,v=(v<<15|v>>>17)+h|0,f+=(h^(v|~u))+y[1]-2054922799|0,f=(f<<21|f>>>11)+v|0,u+=(v^(f|~h))+y[8]+1873313359|0,u=(u<<6|u>>>26)+f|0,h+=(f^(u|~v))+y[15]-30611744|0,h=(h<<10|h>>>22)+u|0,v+=(u^(h|~f))+y[6]-1560198380|0,v=(v<<15|v>>>17)+h|0,f+=(h^(v|~u))+y[13]+1309151649|0,f=(f<<21|f>>>11)+v|0,u+=(v^(f|~h))+y[4]-145523070|0,u=(u<<6|u>>>26)+f|0,h+=(f^(u|~v))+y[11]-1120210379|0,h=(h<<10|h>>>22)+u|0,v+=(u^(h|~f))+y[2]+718787259|0,v=(v<<15|v>>>17)+h|0,f+=(h^(v|~u))+y[9]-343485551|0,f=(f<<21|f>>>11)+v|0,m[0]=u+m[0]|0,m[1]=f+m[1]|0,m[2]=v+m[2]|0,m[3]=h+m[3]|0}function t(m){var y=[],u;for(u=0;u<64;u+=4)y[u>>2]=m.charCodeAt(u)+(m.charCodeAt(u+1)<<8)+(m.charCodeAt(u+2)<<16)+(m.charCodeAt(u+3)<<24);return y}function l(m){var y=[],u;for(u=0;u<64;u+=4)y[u>>2]=m[u]+(m[u+1]<<8)+(m[u+2]<<16)+(m[u+3]<<24);return y}function c(m){var y=m.length,u=[1732584193,-271733879,-1732584194,271733878],f,v,h,S,k,I;for(f=64;f<=y;f+=64)o(u,t(m.substring(f-64,f)));for(m=m.substring(f-64),v=m.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0;f<v;f+=1)h[f>>2]|=m.charCodeAt(f)<<(f%4<<3);if(h[f>>2]|=128<<(f%4<<3),f>55)for(o(u,h),f=0;f<16;f+=1)h[f]=0;return S=y*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(S[2],16),I=parseInt(S[1],16)||0,h[14]=k,h[15]=I,o(u,h),u}function w(m){var y=m.length,u=[1732584193,-271733879,-1732584194,271733878],f,v,h,S,k,I;for(f=64;f<=y;f+=64)o(u,l(m.subarray(f-64,f)));for(m=f-64<y?m.subarray(f-64):new Uint8Array(0),v=m.length,h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0;f<v;f+=1)h[f>>2]|=m[f]<<(f%4<<3);if(h[f>>2]|=128<<(f%4<<3),f>55)for(o(u,h),f=0;f<16;f+=1)h[f]=0;return S=y*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(S[2],16),I=parseInt(S[1],16)||0,h[14]=k,h[15]=I,o(u,h),u}function n(m){var y="",u;for(u=0;u<4;u+=1)y+=i[m>>u*8+4&15]+i[m>>u*8&15];return y}function a(m){var y;for(y=0;y<m.length;y+=1)m[y]=n(m[y]);return m.join("")}a(c("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function m(y,u){return y=y|0||0,y<0?Math.max(y+u,0):Math.min(y,u)}ArrayBuffer.prototype.slice=function(y,u){var f=this.byteLength,v=m(y,f),h=f,S,k,I,F;return u!==e&&(h=m(u,f)),v>h?new ArrayBuffer(0):(S=h-v,k=new ArrayBuffer(S),I=new Uint8Array(k),F=new Uint8Array(this,v,S),I.set(F),k)}}();function d(m){return/[\u0080-\uFFFF]/.test(m)&&(m=unescape(encodeURIComponent(m))),m}function p(m,y){var u=m.length,f=new ArrayBuffer(u),v=new Uint8Array(f),h;for(h=0;h<u;h+=1)v[h]=m.charCodeAt(h);return y?v:f}function g(m){return String.fromCharCode.apply(null,new Uint8Array(m))}function b(m,y,u){var f=new Uint8Array(m.byteLength+y.byteLength);return f.set(new Uint8Array(m)),f.set(new Uint8Array(y),m.byteLength),f}function x(m){var y=[],u=m.length,f;for(f=0;f<u-1;f+=2)y.push(parseInt(m.substr(f,2),16));return String.fromCharCode.apply(String,y)}function _(){this.reset()}return _.prototype.append=function(m){return this.appendBinary(d(m)),this},_.prototype.appendBinary=function(m){this._buff+=m,this._length+=m.length;var y=this._buff.length,u;for(u=64;u<=y;u+=64)o(this._hash,t(this._buff.substring(u-64,u)));return this._buff=this._buff.substring(u-64),this},_.prototype.end=function(m){var y=this._buff,u=y.length,f,v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h;for(f=0;f<u;f+=1)v[f>>2]|=y.charCodeAt(f)<<(f%4<<3);return this._finish(v,u),h=a(this._hash),m&&(h=x(h)),this.reset(),h},_.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},_.prototype.setState=function(m){return this._buff=m.buff,this._length=m.length,this._hash=m.hash,this},_.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},_.prototype._finish=function(m,y){var u=y,f,v,h;if(m[u>>2]|=128<<(u%4<<3),u>55)for(o(this._hash,m),u=0;u<16;u+=1)m[u]=0;f=this._length*8,f=f.toString(16).match(/(.*?)(.{0,8})$/),v=parseInt(f[2],16),h=parseInt(f[1],16)||0,m[14]=v,m[15]=h,o(this._hash,m)},_.hash=function(m,y){return _.hashBinary(d(m),y)},_.hashBinary=function(m,y){var u=c(m),f=a(u);return y?x(f):f},_.ArrayBuffer=function(){this.reset()},_.ArrayBuffer.prototype.append=function(m){var y=b(this._buff.buffer,m),u=y.length,f;for(this._length+=m.byteLength,f=64;f<=u;f+=64)o(this._hash,l(y.subarray(f-64,f)));return this._buff=f-64<u?new Uint8Array(y.buffer.slice(f-64)):new Uint8Array(0),this},_.ArrayBuffer.prototype.end=function(m){var y=this._buff,u=y.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v,h;for(v=0;v<u;v+=1)f[v>>2]|=y[v]<<(v%4<<3);return this._finish(f,u),h=a(this._hash),m&&(h=x(h)),this.reset(),h},_.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.ArrayBuffer.prototype.getState=function(){var m=_.prototype.getState.call(this);return m.buff=g(m.buff),m},_.ArrayBuffer.prototype.setState=function(m){return m.buff=p(m.buff,!0),_.prototype.setState.call(this,m)},_.ArrayBuffer.prototype.destroy=_.prototype.destroy,_.ArrayBuffer.prototype._finish=_.prototype._finish,_.ArrayBuffer.hash=function(m,y){var u=w(new Uint8Array(m)),f=a(u);return y?x(f):f},_})}(Q)),Q.exports}var ht=lt();const dt=Ye(ht);var X=function(){return X=Object.assign||function(s){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},X.apply(this,arguments)},pt=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},vt=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},M=Math.pow(1024,2);function yt(s,r){var e=r*M;if(e>s.size)e=s.size;else for(;s.size>e*1e4;)e*=2;for(var i=[],o=Math.ceil(s.size/e),t=0;t<o;t++){var l=s.slice(e*t,t===o-1?s.size:e*(t+1));i.push(l)}return i}function gt(s){return Object.keys(s).every(function(r){return r.indexOf("x-qn-meta-")===0})}function mt(s){return Object.keys(s).every(function(r){return r.indexOf("x:")===0})}function bt(s){return s.reduce(function(r,e){return r+e},0)}function wt(s,r,e){try{localStorage.setItem(s,JSON.stringify(r))}catch{e.warn(new C(A.WriteCacheFailed,"setLocalFileInfo failed: "+s))}}function _t(s,r,e){var i=r==null?"_":"_key_"+r+"_";return"qiniu_js_sdk_upload_file_name_"+s+i+"size_"+e}function pe(s,r){try{localStorage.removeItem(s)}catch{r.warn(new C(A.RemoveCacheFailed,"removeLocalFileInfo failed. key: "+s))}}function xt(s,r){var e=null;try{e=localStorage.getItem(s)}catch{r.warn(new C(A.ReadCacheFailed,"getLocalFileInfo failed. key: "+s))}if(e==null)return null;var i=null;try{i=JSON.parse(e)}catch{pe(s,r),r.warn(new C(A.InvalidCacheData,"getLocalFileInfo failed to parse. key: "+s))}return i}function W(s){var r="UpToken "+s;return{Authorization:r}}function St(s){var r=W(s);return X({"content-type":"application/octet-stream"},r)}function At(s){var r=W(s);return X({"content-type":"application/json"},r)}function je(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new window.ActiveXObject("Microsoft.XMLHTTP");throw new C(A.NotAvailableXMLHttpRequest,"the current environment does not support.")}function Ct(s){return pt(this,void 0,void 0,function(){var r,e;return vt(this,function(i){switch(i.label){case 0:return[4,kt(s)];case 1:return r=i.sent(),e=new dt.ArrayBuffer,e.append(r),[2,e.end()]}})})}function kt(s){return new Promise(function(r,e){var i=new FileReader;i.onload=function(o){if(o.target){var t=o.target.result;r(t)}else e(new C(A.InvalidProgressEventTarget,"progress event target is undefined"))},i.onerror=function(){e(new C(A.FileReaderReadFailed,"fileReader read failed"))},i.readAsArrayBuffer(s)})}function V(s,r){return new Promise(function(e,i){var o=je();if(o.open(r.method,s),r.onCreate&&r.onCreate(o),r.headers){var t=r.headers;Object.keys(t).forEach(function(l){o.setRequestHeader(l,t[l])})}o.upload.addEventListener("progress",function(l){l.lengthComputable&&r.onProgress&&r.onProgress({loaded:l.loaded,total:l.total})}),o.onreadystatechange=function(){var l=o.responseText;if(o.readyState===4){var c=o.getResponseHeader("x-reqId")||"";if(o.status===0){i(new et("network error.",c));return}if(o.status!==200){var w="xhr request failed, code: "+o.status;l&&(w+=" response: "+l);var n=void 0;try{n=JSON.parse(l)}catch{}i(new G(o.status,c,w,n));return}try{e({data:JSON.parse(l),reqId:c})}catch(a){i(a)}}},o.send(r.body)})}function Ot(s){if(s&&s.match){var r=s.match(/(^https?)/);if(!r)return"";var e=r[1];return r=s.match(/^https?:\/\/([^:^/]*):(\d*)/),r?r[2]:e==="http"?"80":"443"}return""}function It(s){if(s&&s.match){var r=s.match(/^https?:\/\/([^:^/]*)/);return r?r[1]:""}return""}function ve(s){if(!s)throw new C(A.InvalidToken,"invalid token.");var r=s.split(":");if(r.length===1)throw new C(A.InvalidToken,"invalid token segments.");var e=r.length>3?r[1]:r[0];if(!e)throw new C(A.InvalidToken,"missing assess key field.");var i=null;try{i=JSON.parse(ct(r[r.length-1]))}catch{throw new C(A.InvalidToken,"token parse failed.")}if(i==null)throw new C(A.InvalidToken,"putPolicy is null.");if(i.scope==null)throw new C(A.InvalidToken,"scope field is null.");var o=i.scope.split(":")[0];if(!o)throw new C(A.InvalidToken,"resolve bucketName failed.");return{assessKey:e,bucketName:o,scope:i.scope}}var T,q={z0:"z0",z1:"z1",z2:"z2",na0:"na0",as0:"as0",cnEast2:"cn-east-2"},Ut=(T={},T[q.z0]={srcUphost:["up.qiniup.com"],cdnUphost:["upload.qiniup.com"]},T[q.z1]={srcUphost:["up-z1.qiniup.com"],cdnUphost:["upload-z1.qiniup.com"]},T[q.z2]={srcUphost:["up-z2.qiniup.com"],cdnUphost:["upload-z2.qiniup.com"]},T[q.na0]={srcUphost:["up-na0.qiniup.com"],cdnUphost:["upload-na0.qiniup.com"]},T[q.as0]={srcUphost:["up-as0.qiniup.com"],cdnUphost:["upload-as0.qiniup.com"]},T[q.cnEast2]={srcUphost:["up-cn-east-2.qiniup.com"],cdnUphost:["upload-cn-east-2.qiniup.com"]},T),P={},ee,ge;function Ft(){if(ge)return ee;ge=1;function s(r,e){return Object.prototype.hasOwnProperty.call(r,e)}return ee=function(r,e,i,o){e=e||"&",i=i||"=";var t={};if(typeof r!="string"||r.length===0)return t;var l=/\+/g;r=r.split(e);var c=1e3;o&&typeof o.maxKeys=="number"&&(c=o.maxKeys);var w=r.length;c>0&&w>c&&(w=c);for(var n=0;n<w;++n){var a=r[n].replace(l,"%20"),d=a.indexOf(i),p,g,b,x;d>=0?(p=a.substr(0,d),g=a.substr(d+1)):(p=a,g=""),b=decodeURIComponent(p),x=decodeURIComponent(g),s(t,b)?Array.isArray(t[b])?t[b].push(x):t[b]=[t[b],x]:t[b]=x}return t},ee}var te,me;function Rt(){if(me)return te;me=1;var s=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};return te=function(r,e,i,o){return e=e||"&",i=i||"=",r===null&&(r=void 0),typeof r=="object"?Object.keys(r).map(function(t){var l=encodeURIComponent(s(t))+i;return Array.isArray(r[t])?r[t].map(function(c){return l+encodeURIComponent(s(c))}).join(e):l+encodeURIComponent(s(r[t]))}).filter(Boolean).join(e):o?encodeURIComponent(s(o))+i+encodeURIComponent(s(r)):""},te}var be;function Tt(){return be||(be=1,P.decode=P.parse=Ft(),P.encode=P.stringify=Rt()),P}var zt=Tt(),B=function(){return B=Object.assign||function(s){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},B.apply(this,arguments)},Et=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},Bt=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};function Lt(s,r,e){return Et(this,void 0,void 0,function(){var i,o;return Bt(this,function(t){return i=zt.stringify({ak:s,bucket:r}),o=e+"://api.qiniu.com/v2/query?"+i,[2,V(o,{method:"GET"})]})})}function $e(s,r,e){var i=e.url,o=e.id;return i+"/buckets/"+s+"/objects/"+(r!=null?He(r):"~")+"/uploads/"+o}function qt(s,r,e,i){var o=i+"/buckets/"+r+"/objects/"+(e!=null?He(e):"~")+"/uploads";return V(o,{method:"POST",headers:W(s)})}function Pt(s,r,e,i,o){var t=ve(s).bucketName,l=$e(t,r,i)+("/"+e),c=St(s);return o.md5&&(c["Content-MD5"]=o.md5),V(l,B(B({},o),{method:"PUT",headers:c}))}function Mt(s,r,e,i){var o=ve(s).bucketName,t=$e(o,r,e);return V(t,B(B({},i),{method:"POST",headers:At(s)}))}function Dt(s,r,e){return V(s,B({method:"POST",body:r},e))}var J=function(){return J=Object.assign||function(s){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},J.apply(this,arguments)},we=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},_e=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},Ht=function(s,r){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,t=[],l;try{for(;(r===void 0||r-- >0)&&!(o=i.next()).done;)t.push(o.value)}catch(c){l={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(l)throw l.error}}return t},jt=function(){for(var s=[],r=0;r<arguments.length;r++)s=s.concat(Ht(arguments[r]));return s},$t=4,Ke=[0,502,503,504,599],Kt=jt(Ke,[406]),Gt=Math.pow(1024,3),Ge=function(){function s(r,e,i,o){this.hostPool=i,this.logger=o,this.aborted=!1,this.retryCount=0,this.xhrList=[],this.config=r.config,o.info("config inited.",this.config),this.putExtra=J({fname:""},r.putExtra),o.info("putExtra inited.",this.putExtra),this.key=r.key,this.file=r.file,this.token=r.token,this.onData=e.onData,this.onError=e.onError,this.onComplete=e.onComplete;try{var t=ve(this.token);this.bucketName=t.bucketName,this.assessKey=t.assessKey}catch(l){o.error("get putPolicy from token failed.",l),this.onError(l)}}return s.prototype.checkAndUpdateUploadHost=function(){return we(this,void 0,void 0,function(){var r;return _e(this,function(e){switch(e.label){case 0:return this.logger.info("get available upload host."),[4,this.hostPool.getUp(this.assessKey,this.bucketName,this.config.upprotocol)];case 1:if(r=e.sent(),r==null)throw new C(A.NotAvailableUploadHost,"no available upload host.");return this.uploadHost!=null&&this.uploadHost.host!==r.host?this.logger.warn("host switches from "+this.uploadHost.host+" to "+r.host+"."):this.logger.info("use host "+r.host+"."),this.uploadHost=r,[2]}})})},s.prototype.checkAndUnfreezeHost=function(){this.logger.info("check unfreeze host."),this.uploadHost!=null&&this.uploadHost.isFrozen()&&(this.logger.warn(this.uploadHost.host+" will be unfrozen."),this.uploadHost.unfreeze())},s.prototype.checkAndFreezeHost=function(r){this.logger.info("check freeze host."),r instanceof G&&this.uploadHost!=null&&Ke.includes(r.code)&&(this.logger.warn(this.uploadHost.host+" will be temporarily frozen."),this.uploadHost.freeze())},s.prototype.handleError=function(r){this.logger.error(r.message),this.onError(r)},s.prototype.putFile=function(){return we(this,void 0,void 0,function(){var r,e,i,o;return _e(this,function(t){switch(t.label){case 0:if(this.aborted=!1,this.putExtra.fname||(this.logger.info("use file.name as fname."),this.putExtra.fname=this.file.name),this.file.size>1e4*Gt)return this.handleError(new C(A.InvalidFile,"file size exceed maximum value 10000G")),[2];if(this.putExtra.customVars&&!mt(this.putExtra.customVars))return this.handleError(new C(A.InvalidCustomVars,"customVars key should start width x:")),[2];if(this.putExtra.metadata&&!gt(this.putExtra.metadata))return this.handleError(new C(A.InvalidMetadata,"metadata key should start with x-qn-meta-")),[2];t.label=1;case 1:return t.trys.push([1,4,,5]),this.uploadAt=new Date().getTime(),[4,this.checkAndUpdateUploadHost()];case 2:return t.sent(),[4,this.run()];case 3:return r=t.sent(),this.onComplete(r.data),this.checkAndUnfreezeHost(),this.sendLog(r.reqId,200),[2];case 4:return e=t.sent(),this.aborted?(this.logger.warn("upload is aborted."),this.sendLog("",-2),[2]):(this.clear(),this.logger.error(e),e instanceof G&&(this.sendLog(e.reqId,e.code),this.checkAndFreezeHost(e),i=++this.retryCount<=this.config.retryCount,o=Kt.includes(e.code),o&&i)?(this.logger.warn("error auto retry: "+this.retryCount+"/"+this.config.retryCount+"."),this.putFile(),[2]):(this.onError(e),[3,5]));case 5:return[2]}})})},s.prototype.clear=function(){this.xhrList.forEach(function(r){r.onreadystatechange=null,r.abort()}),this.xhrList=[],this.logger.info("cleanup uploading xhr.")},s.prototype.stop=function(){this.logger.info("aborted."),this.clear(),this.aborted=!0},s.prototype.addXhr=function(r){this.xhrList.push(r)},s.prototype.sendLog=function(r,e){var i,o;this.logger.report({code:e,reqId:r,remoteIp:"",upType:"jssdk-h5",size:this.file.size,time:Math.floor(this.uploadAt/1e3),port:Ot((i=this.uploadHost)===null||i===void 0?void 0:i.getUrl()),host:It((o=this.uploadHost)===null||o===void 0?void 0:o.getUrl()),bytesSent:this.progress?this.progress.total.loaded:0,duration:Math.floor((new Date().getTime()-this.uploadAt)/1e3)})},s.prototype.getProgressInfoItem=function(r,e,i){return J({size:e,loaded:r,percent:r/e*100},i==null?{}:{fromCache:i})},s}(),Vt=function(){var s=function(r,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var t in o)o.hasOwnProperty(t)&&(i[t]=o[t])},s(r,e)};return function(r,e){s(r,e);function i(){this.constructor=r}r.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),K=function(){return K=Object.assign||function(s){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},K.apply(this,arguments)},H=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},j=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};function Nt(s){var r=/^[1-9]\d*$/;return r.test(String(s))}var Xt=function(s){Vt(r,s);function r(){return s!==null&&s.apply(this,arguments)||this}return r.prototype.run=function(){return H(this,void 0,void 0,function(){var e,i,o,t,l,c=this;return j(this,function(w){switch(w.label){case 0:if(this.logger.info("start run Resume."),!this.config.chunkSize||!Nt(this.config.chunkSize))throw new C(A.InvalidChunkSize,"chunkSize must be a positive integer");if(this.config.chunkSize>1024)throw new C(A.InvalidChunkSize,"chunkSize maximum value is 1024");return[4,this.initBeforeUploadChunks()];case 1:w.sent(),e=new tt(function(n){return H(c,void 0,void 0,function(){return j(this,function(a){switch(a.label){case 0:if(this.aborted)throw e.abort(),new Error("pool is aborted");return[4,this.uploadChunk(n)];case 1:return a.sent(),[2]}})})},this.config.concurrentRequestLimit),i=null,o=this.getLocalKey(),t=this.chunks.map(function(n,a){return e.enqueue({chunk:n,index:a})}),w.label=2;case 2:return w.trys.push([2,5,,6]),[4,Promise.all(t)];case 3:return w.sent(),[4,this.mkFileReq()];case 4:return i=w.sent(),[3,6];case 5:throw l=w.sent(),l instanceof G&&(l.code===612||l.code===400)&&pe(o,this.logger),l;case 6:return pe(o,this.logger),[2,i]}})})},r.prototype.uploadChunk=function(e){return H(this,void 0,void 0,function(){var i,o,t,l,c,w,n,a,d,p=this;return j(this,function(g){switch(g.label){case 0:return i=e.index,o=e.chunk,t=this.cachedUploadedList[i],this.logger.info("upload part "+i+", cache:",t),l=this.config.checkByMD5,c=function(){p.usedCacheList[i]=!0,p.updateChunkProgress(o.size,i),p.uploadedList[i]=t,p.updateLocalCache()},t&&!l?(c(),[2]):[4,Ct(o)];case 1:return w=g.sent(),this.logger.info("computed part md5.",w),t&&w===t.md5?(c(),[2]):(this.usedCacheList[i]=!1,n=function(b){p.updateChunkProgress(b.loaded,i)},a={body:o,md5:this.config.checkByServer?w:void 0,onProgress:n,onCreate:function(b){return p.addXhr(b)}},this.logger.info("part "+i+" start uploading."),[4,Pt(this.token,this.key,e.index+1,this.getUploadInfo(),a)]);case 2:return d=g.sent(),this.logger.info("part "+i+" upload completed."),n({loaded:o.size,total:o.size}),this.uploadedList[i]={etag:d.data.etag,md5:d.data.md5,size:o.size},this.updateLocalCache(),[2]}})})},r.prototype.mkFileReq=function(){return H(this,void 0,void 0,function(){var e,i,o=this;return j(this,function(t){switch(t.label){case 0:return e=K(K(K({parts:this.uploadedList.map(function(l,c){return{etag:l.etag,partNumber:c+1}}),fname:this.putExtra.fname},this.putExtra.mimeType&&{mimeType:this.putExtra.mimeType}),this.putExtra.customVars&&{customVars:this.putExtra.customVars}),this.putExtra.metadata&&{metadata:this.putExtra.metadata}),this.logger.info("parts upload completed, make file.",e),[4,Mt(this.token,this.key,this.getUploadInfo(),{onCreate:function(l){return o.addXhr(l)},body:JSON.stringify(e)})];case 1:return i=t.sent(),this.logger.info("finish Resume Progress."),this.updateMkFileProgress(1),[2,i]}})})},r.prototype.initBeforeUploadChunks=function(){return H(this,void 0,void 0,function(){var e,i,o;return j(this,function(t){switch(t.label){case 0:return this.uploadedList=[],this.usedCacheList=[],e=xt(this.getLocalKey(),this.logger),e?[3,2]:(this.logger.info("init upload parts from api."),[4,qt(this.token,this.bucketName,this.key,this.uploadHost.getUrl())]);case 1:return i=t.sent(),this.logger.info("initd upload parts of id: "+i.data.uploadId+"."),this.uploadId=i.data.uploadId,this.cachedUploadedList=[],[3,3];case 2:o=["resume upload parts from local cache,","total "+e.data.length+" part,","id is "+e.id+"."],this.logger.info(o.join(" ")),this.cachedUploadedList=e.data,this.uploadId=e.id,t.label=3;case 3:return this.chunks=yt(this.file,this.config.chunkSize),this.loaded={mkFileProgress:0,chunks:this.chunks.map(function(l){return 0})},this.notifyResumeProgress(),[2]}})})},r.prototype.getUploadInfo=function(){return{id:this.uploadId,url:this.uploadHost.getUrl()}},r.prototype.getLocalKey=function(){return _t(this.file.name,this.key,this.file.size)},r.prototype.updateLocalCache=function(){wt(this.getLocalKey(),{id:this.uploadId,data:this.uploadedList},this.logger)},r.prototype.updateChunkProgress=function(e,i){this.loaded.chunks[i]=e,this.notifyResumeProgress()},r.prototype.updateMkFileProgress=function(e){this.loaded.mkFileProgress=e,this.notifyResumeProgress()},r.prototype.notifyResumeProgress=function(){var e=this;this.progress={total:this.getProgressInfoItem(bt(this.loaded.chunks)+this.loaded.mkFileProgress,this.file.size+1),chunks:this.chunks.map(function(i,o){var t=e.usedCacheList[o];return e.getProgressInfoItem(e.loaded.chunks[o],i.size,t)}),uploadInfo:{id:this.uploadId,url:this.uploadHost.getUrl()}},this.onData(this.progress)},r}(Ge),xe=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},Se=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},Jt=function(){function s(){this.crc=-1,this.table=this.makeTable()}return s.prototype.makeTable=function(){for(var r=new Array,e=0;e<256;e++){for(var i=e,o=0;o<8;o++)i&1?i=i>>>1^3988292384:i>>>=1;r[e]=i}return r},s.prototype.append=function(r){for(var e=this.crc,i=0;i<r.byteLength;i++)e=e>>>8^this.table[(e^r[i])&255];this.crc=e},s.prototype.compute=function(){return(this.crc^-1)>>>0},s.prototype.readAsUint8Array=function(r){return xe(this,void 0,void 0,function(){var e;return Se(this,function(i){switch(i.label){case 0:return typeof r.arrayBuffer!="function"?[3,2]:(e=Uint8Array.bind,[4,r.arrayBuffer()]);case 1:return[2,new(e.apply(Uint8Array,[void 0,i.sent()]))];case 2:return[2,new Promise(function(o,t){var l=new FileReader;l.onload=function(){if(l.result==null){t();return}if(typeof l.result=="string"){t();return}o(new Uint8Array(l.result))},l.readAsArrayBuffer(r)})]}})})},s.prototype.file=function(r){return xe(this,void 0,void 0,function(){var e,i,o,t,l,c;return Se(this,function(w){switch(w.label){case 0:return r.size<=M?(e=this.append,[4,this.readAsUint8Array(r)]):[3,2];case 1:return e.apply(this,[w.sent()]),[2,this.compute()];case 2:i=Math.ceil(r.size/M),o=0,w.label=3;case 3:return o<i?(t=o*M,l=o===i-1?r.size:t+M,[4,this.readAsUint8Array(r.slice(t,l))]):[3,6];case 4:c=w.sent(),this.append(new Uint8Array(c)),w.label=5;case 5:return o++,[3,3];case 6:return[2,this.compute()]}})})},s.file=function(r){var e=new s;return e.file(r)},s}(),Wt=function(){var s=function(r,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var t in o)o.hasOwnProperty(t)&&(i[t]=o[t])},s(r,e)};return function(r,e){s(r,e);function i(){this.constructor=r}r.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Zt=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},Yt=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},Ae=function(s){Wt(r,s);function r(){return s!==null&&s.apply(this,arguments)||this}return r.prototype.run=function(){return Zt(this,void 0,void 0,function(){var e,i,o,t,l,c=this;return Yt(this,function(w){switch(w.label){case 0:return this.logger.info("start run Direct."),e=new FormData,e.append("file",this.file),e.append("token",this.token),this.key!=null&&e.append("key",this.key),e.append("fname",this.putExtra.fname),this.config.checkByServer?[4,Jt.file(this.file)]:[3,2];case 1:i=w.sent(),e.append("crc32",i.toString()),w.label=2;case 2:return this.putExtra.customVars&&(this.logger.info("init customVars."),o=this.putExtra.customVars,Object.keys(o).forEach(function(n){return e.append(n,o[n].toString())}),this.logger.info("customVars inited.")),this.putExtra.metadata&&(this.logger.info("init metadata."),t=this.putExtra.metadata,Object.keys(t).forEach(function(n){return e.append(n,t[n].toString())})),this.logger.info("formData inited."),[4,Dt(this.uploadHost.getUrl(),e,{onProgress:function(n){c.updateDirectProgress(n.loaded,n.total)},onCreate:function(n){return c.addXhr(n)}})];case 3:return l=w.sent(),this.logger.info("Direct progress finish."),this.finishDirectProgress(),[2,l]}})})},r.prototype.updateDirectProgress=function(e,i){this.progress={total:this.getProgressInfoItem(e,i+1)},this.onData(this.progress)},r.prototype.finishDirectProgress=function(){if(!this.progress){this.logger.warn("progress is null."),this.progress={total:this.getProgressInfoItem(this.file.size,this.file.size)},this.onData(this.progress);return}var e=this.progress.total;this.progress={total:this.getProgressInfoItem(e.loaded+1,e.size)},this.onData(this.progress)},r}(Ge);function Ve(s,r,e){e===void 0&&(e=3);var i=je();i.open("POST","https://uplog.qbox.me/log/3"),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.setRequestHeader("Authorization",W(s).Authorization),i.onreadystatechange=function(){i.readyState===4&&i.status!==200&&e>0&&Ve(s,r,e-1)};var o=[r.code||"",r.reqId||"",r.host||"",r.remoteIp||"",r.port||"",r.duration||"",r.time||"",r.bytesSent||"",r.upType||"",r.size||""].join(",");i.send(o)}var Qt=function(s,r){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,t=[],l;try{for(;(r===void 0||r-- >0)&&!(o=i.next()).done;)t.push(o.value)}catch(c){l={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(l)throw l.error}}return t},re=function(){for(var s=[],r=0;r<arguments.length;r++)s=s.concat(Qt(arguments[r]));return s},er=function(){function s(r,e,i,o){e===void 0&&(e=!0),i===void 0&&(i="OFF"),o===void 0&&(o="UPLOAD"),this.token=r,this.disableReport=e,this.level=i,this.prefix=o,this.id=++s.id}return s.prototype.getPrintPrefix=function(r){return"Qiniu-JS-SDK ["+r+"]["+this.prefix+"#"+this.id+"]:"},s.prototype.report=function(r,e){if(!this.disableReport)try{Ve(this.token,r,e)}catch(i){this.warn(i)}},s.prototype.info=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var i=["INFO"];i.includes(this.level)&&console.log.apply(console,re([this.getPrintPrefix("INFO")],r))},s.prototype.warn=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var i=["INFO","WARN"];i.includes(this.level)&&console.warn.apply(console,re([this.getPrintPrefix("WARN")],r))},s.prototype.error=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var i=["INFO","WARN","ERROR"];i.includes(this.level)&&console.error.apply(console,re([this.getPrintPrefix("ERROR")],r))},s.id=0,s}(),Ce=function(s,r,e,i){function o(t){return t instanceof e?t:new e(function(l){l(t)})}return new(e||(e=Promise))(function(t,l){function c(a){try{n(i.next(a))}catch(d){l(d)}}function w(a){try{n(i.throw(a))}catch(d){l(d)}}function n(a){a.done?t(a.value):o(a.value).then(c,w)}n((i=i.apply(s,r||[])).next())})},ke=function(s,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},i,o,t,l;return l={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(n){return function(a){return w([n,a])}}function w(n){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,o&&(t=n[0]&2?o.return:n[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,n[1])).done)return t;switch(o=0,t&&(n=[n[0]&2,t.value]),n[0]){case 0:case 1:t=n;break;case 4:return e.label++,{value:n[1],done:!1};case 5:e.label++,o=n[1],n=[0];continue;case 7:n=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(n[0]===6||n[0]===2)){e=0;continue}if(n[0]===3&&(!t||n[1]>t[0]&&n[1]<t[3])){e.label=n[1];break}if(n[0]===6&&e.label<t[1]){e.label=t[1],t=n;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(n);break}t[2]&&e.ops.pop(),e.trys.pop();continue}n=r.call(s,e)}catch(a){n=[6,a],o=0}finally{i=t=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},tr=function(s,r){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,t=[],l;try{for(;(r===void 0||r-- >0)&&!(o=i.next()).done;)t.push(o.value)}catch(c){l={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(l)throw l.error}}return t},rr=function(){for(var s=[],r=0;r<arguments.length;r++)s=s.concat(tr(arguments[r]));return s},N=new Map,nr=function(){function s(r,e){this.host=r,this.protocol=e}return s.prototype.isFrozen=function(){var r=new Date().getTime(),e=N.get(this.host);return e!=null&&e>=r},s.prototype.freeze=function(r){r===void 0&&(r=20);var e=new Date().getTime()+r*1e3;N.set(this.host,e)},s.prototype.unfreeze=function(){N.delete(this.host)},s.prototype.getUrl=function(){return this.protocol+"://"+this.host},s.prototype.getUnfreezeTime=function(){return N.get(this.host)},s}(),ir=function(){function s(r){r===void 0&&(r=[]),this.initHosts=r,this.cachedHostsMap=new Map}return s.prototype.register=function(r,e,i,o){this.cachedHostsMap.set(r+"@"+e,i.map(function(t){return new nr(t,o)}))},s.prototype.refresh=function(r,e,i){var o,t,l,c;return Ce(this,void 0,void 0,function(){var w,n,a;return ke(this,function(d){switch(d.label){case 0:return w=this.cachedHostsMap.get(r+"@"+e)||[],w.length>0?[2]:this.initHosts.length>0?(this.register(r,e,this.initHosts,i),[2]):[4,Lt(r,e,i)];case 1:return n=d.sent(),(n==null?void 0:n.data)!=null&&(a=rr(((t=(o=n.data.up)===null||o===void 0?void 0:o.acc)===null||t===void 0?void 0:t.main)||[],((c=(l=n.data.up)===null||l===void 0?void 0:l.acc)===null||c===void 0?void 0:c.backup)||[]),this.register(r,e,a,i)),[2]}})})},s.prototype.getUp=function(r,e,i){return Ce(this,void 0,void 0,function(){var o,t,l;return ke(this,function(c){switch(c.label){case 0:return[4,this.refresh(r,e,i)];case 1:return c.sent(),o=this.cachedHostsMap.get(r+"@"+e)||[],o.length===0?[2,null]:(t=o.filter(function(w){return!w.isFrozen()}),t.length>0?[2,t[0]]:(l=o.slice().sort(function(w,n){return(w.getUnfreezeTime()||0)-(n.getUnfreezeTime()||0)}),[2,l[0]]))}})})},s}();function or(s,r,e,i){return s.config&&s.config.forceDirect?(i.info("ues forceDirect mode."),new Ae(s,r,e,i)):s.file.size>4*M?(i.info("file size over 4M, use Resume."),new Xt(s,r,e,i)):(i.info("file size less or equal than 4M, use Direct."),new Ae(s,r,e,i))}function br(s,r,e,i,o){var t=new er(e,o==null?void 0:o.disableStatisticsReport,o==null?void 0:o.debugLogLevel,s.name),l={file:s,key:r,token:e,putExtra:i,config:ur(o,t)},c=new ir(l.config.uphost);return new ot(function(w){var n=or(l,{onData:function(a){return w.next(a)},onError:function(a){return w.error(a)},onComplete:function(a){return w.complete(a)}},c,t);return n.putFile(),n.stop.bind(n)})}var D=function(){return D=Object.assign||function(s){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},D.apply(this,arguments)},ar=function(s,r){var e={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&r.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)r.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(e[i[o]]=s[i[o]]);return e},sr=function(s,r){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),o,t=[],l;try{for(;(r===void 0||r-- >0)&&!(o=i.next()).done;)t.push(o.value)}catch(c){l={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(l)throw l.error}}return t},ne=function(){for(var s=[],r=0;r<arguments.length;r++)s=s.concat(sr(arguments[r]));return s};function ur(s,r){var e=D({},s),i=e.upprotocol,o=e.uphost,t=ar(e,["upprotocol","uphost"]),l=D({uphost:[],retryCount:3,checkByMD5:!1,forceDirect:!1,useCdnDomain:!0,checkByServer:!0,concurrentRequestLimit:3,chunkSize:$t,upprotocol:"https",debugLogLevel:"OFF",disableStatisticsReport:!1},t);i&&(l.upprotocol=i.replace(/:$/,""));var c=[];if(r&&(s==null?void 0:s.uphost)!=null&&(s==null?void 0:s.region)!=null&&r.warn("do not use both the uphost and region config."),o)Array.isArray(o)?c.push.apply(c,ne(o)):c.push(o);else if(l!=null&&l.region){var w=Ut[l==null?void 0:l.region];l.useCdnDomain?c.push.apply(c,ne(w.cdnUphost)):c.push.apply(c,ne(w.srcUphost))}return D(D({},l),{uphost:c.filter(Boolean)})}var Oe={PNG:"image/png",JPEG:"image/jpeg",WEBP:"image/webp",BMP:"image/bmp"};Object.keys(Oe).map(function(s){return Oe[s]});var ie={},oe={exports:{}},Ie;function Ne(){return Ie||(Ie=1,function(s){function r(e){return e&&e.__esModule?e:{default:e}}s.exports=r,s.exports.__esModule=!0,s.exports.default=s.exports}(oe)),oe.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var ae,Ue;function fr(){if(Ue)return ae;Ue=1;var s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;function i(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function o(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var l={},c=0;c<10;c++)l["_"+String.fromCharCode(c)]=c;var w=Object.getOwnPropertyNames(l).map(function(a){return l[a]});if(w.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(a){n[a]=a}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return ae=o()?Object.assign:function(t,l){for(var c,w=i(t),n,a=1;a<arguments.length;a++){c=Object(arguments[a]);for(var d in c)r.call(c,d)&&(w[d]=c[d]);if(s){n=s(c);for(var p=0;p<n.length;p++)e.call(c,n[p])&&(w[n[p]]=c[n[p]])}}return w},ae}var se={},Fe;function cr(){return Fe||(Fe=1,function(s){s.__esModule=!0,s.default=r;function r(e,i){return i===void 0&&(i={}),new Promise(function(o,t){var l=i,c=l.async,w=c===void 0?!0:c,n=l.data,a=n===void 0?null:n,d=l.headers,p=d===void 0?{}:d,g=l.method,b=g===void 0?"get":g,x=l.timeout,_=x===void 0?0:x,m=l.onprogress,y=new XMLHttpRequest,u;_&&(u=setTimeout(function(){t(new Error("the request timeout "+_+"ms"))},_)),y.onerror=function(){t(new Error("unknown error"))},y.upload&&(y.upload.onprogress=m),y.onreadystatechange=function(){if(y.readyState===4)if(_&&clearTimeout(u),y.status>=200&&y.status<300)o(y.response,y);else{var f=new Error("the request is error");t(f)}},y.open(b,e,w),Object.keys(p).forEach(function(f){y.setRequestHeader(f,p[f])});try{y.send(a)}catch(f){t(f)}})}}(se)),se}var R={},ue={exports:{}},fe={exports:{}},Re;function lr(){return Re||(Re=1,function(){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,i){return e<<i|e>>>32-i},rotr:function(e,i){return e<<32-i|e>>>i},endian:function(e){if(e.constructor==Number)return r.rotl(e,8)&16711935|r.rotl(e,24)&4278255360;for(var i=0;i<e.length;i++)e[i]=r.endian(e[i]);return e},randomBytes:function(e){for(var i=[];e>0;e--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(e){for(var i=[],o=0,t=0;o<e.length;o++,t+=8)i[t>>>5]|=e[o]<<24-t%32;return i},wordsToBytes:function(e){for(var i=[],o=0;o<e.length*32;o+=8)i.push(e[o>>>5]>>>24-o%32&255);return i},bytesToHex:function(e){for(var i=[],o=0;o<e.length;o++)i.push((e[o]>>>4).toString(16)),i.push((e[o]&15).toString(16));return i.join("")},hexToBytes:function(e){for(var i=[],o=0;o<e.length;o+=2)i.push(parseInt(e.substr(o,2),16));return i},bytesToBase64:function(e){for(var i=[],o=0;o<e.length;o+=3)for(var t=e[o]<<16|e[o+1]<<8|e[o+2],l=0;l<4;l++)o*8+l*6<=e.length*8?i.push(s.charAt(t>>>6*(3-l)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],o=0,t=0;o<e.length;t=++o%4)t!=0&&i.push((s.indexOf(e.charAt(o-1))&Math.pow(2,-2*t+8)-1)<<t*2|s.indexOf(e.charAt(o))>>>6-t*2);return i}};fe.exports=r}()),fe.exports}var ce,Te;function ze(){if(Te)return ce;Te=1;var s={utf8:{stringToBytes:function(r){return s.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(s.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var e=[],i=0;i<r.length;i++)e.push(r.charCodeAt(i)&255);return e},bytesToString:function(r){for(var e=[],i=0;i<r.length;i++)e.push(String.fromCharCode(r[i]));return e.join("")}}};return ce=s,ce}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var le,Ee;function hr(){if(Ee)return le;Ee=1,le=function(e){return e!=null&&(s(e)||r(e)||!!e._isBuffer)};function s(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function r(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&s(e.slice(0,0))}return le}var Be;function dr(){return Be||(Be=1,function(){var s=lr(),r=ze().utf8,e=hr(),i=ze().bin,o=function(t,l){t.constructor==String?l&&l.encoding==="binary"?t=i.stringToBytes(t):t=r.stringToBytes(t):e(t)?t=Array.prototype.slice.call(t,0):!Array.isArray(t)&&t.constructor!==Uint8Array&&(t=t.toString());for(var c=s.bytesToWords(t),w=t.length*8,n=1732584193,a=-271733879,d=-1732584194,p=271733878,g=0;g<c.length;g++)c[g]=(c[g]<<8|c[g]>>>24)&16711935|(c[g]<<24|c[g]>>>8)&4278255360;c[w>>>5]|=128<<w%32,c[(w+64>>>9<<4)+14]=w;for(var b=o._ff,x=o._gg,_=o._hh,m=o._ii,g=0;g<c.length;g+=16){var y=n,u=a,f=d,v=p;n=b(n,a,d,p,c[g+0],7,-680876936),p=b(p,n,a,d,c[g+1],12,-389564586),d=b(d,p,n,a,c[g+2],17,606105819),a=b(a,d,p,n,c[g+3],22,-1044525330),n=b(n,a,d,p,c[g+4],7,-176418897),p=b(p,n,a,d,c[g+5],12,1200080426),d=b(d,p,n,a,c[g+6],17,-1473231341),a=b(a,d,p,n,c[g+7],22,-45705983),n=b(n,a,d,p,c[g+8],7,1770035416),p=b(p,n,a,d,c[g+9],12,-1958414417),d=b(d,p,n,a,c[g+10],17,-42063),a=b(a,d,p,n,c[g+11],22,-1990404162),n=b(n,a,d,p,c[g+12],7,1804603682),p=b(p,n,a,d,c[g+13],12,-40341101),d=b(d,p,n,a,c[g+14],17,-1502002290),a=b(a,d,p,n,c[g+15],22,1236535329),n=x(n,a,d,p,c[g+1],5,-165796510),p=x(p,n,a,d,c[g+6],9,-1069501632),d=x(d,p,n,a,c[g+11],14,643717713),a=x(a,d,p,n,c[g+0],20,-373897302),n=x(n,a,d,p,c[g+5],5,-701558691),p=x(p,n,a,d,c[g+10],9,38016083),d=x(d,p,n,a,c[g+15],14,-660478335),a=x(a,d,p,n,c[g+4],20,-405537848),n=x(n,a,d,p,c[g+9],5,568446438),p=x(p,n,a,d,c[g+14],9,-1019803690),d=x(d,p,n,a,c[g+3],14,-187363961),a=x(a,d,p,n,c[g+8],20,1163531501),n=x(n,a,d,p,c[g+13],5,-1444681467),p=x(p,n,a,d,c[g+2],9,-51403784),d=x(d,p,n,a,c[g+7],14,1735328473),a=x(a,d,p,n,c[g+12],20,-1926607734),n=_(n,a,d,p,c[g+5],4,-378558),p=_(p,n,a,d,c[g+8],11,-2022574463),d=_(d,p,n,a,c[g+11],16,1839030562),a=_(a,d,p,n,c[g+14],23,-35309556),n=_(n,a,d,p,c[g+1],4,-1530992060),p=_(p,n,a,d,c[g+4],11,1272893353),d=_(d,p,n,a,c[g+7],16,-155497632),a=_(a,d,p,n,c[g+10],23,-1094730640),n=_(n,a,d,p,c[g+13],4,681279174),p=_(p,n,a,d,c[g+0],11,-358537222),d=_(d,p,n,a,c[g+3],16,-722521979),a=_(a,d,p,n,c[g+6],23,76029189),n=_(n,a,d,p,c[g+9],4,-640364487),p=_(p,n,a,d,c[g+12],11,-421815835),d=_(d,p,n,a,c[g+15],16,530742520),a=_(a,d,p,n,c[g+2],23,-995338651),n=m(n,a,d,p,c[g+0],6,-198630844),p=m(p,n,a,d,c[g+7],10,1126891415),d=m(d,p,n,a,c[g+14],15,-1416354905),a=m(a,d,p,n,c[g+5],21,-57434055),n=m(n,a,d,p,c[g+12],6,1700485571),p=m(p,n,a,d,c[g+3],10,-1894986606),d=m(d,p,n,a,c[g+10],15,-1051523),a=m(a,d,p,n,c[g+1],21,-2054922799),n=m(n,a,d,p,c[g+8],6,1873313359),p=m(p,n,a,d,c[g+15],10,-30611744),d=m(d,p,n,a,c[g+6],15,-1560198380),a=m(a,d,p,n,c[g+13],21,1309151649),n=m(n,a,d,p,c[g+4],6,-145523070),p=m(p,n,a,d,c[g+11],10,-1120210379),d=m(d,p,n,a,c[g+2],15,718787259),a=m(a,d,p,n,c[g+9],21,-343485551),n=n+y>>>0,a=a+u>>>0,d=d+f>>>0,p=p+v>>>0}return s.endian([n,a,d,p])};o._ff=function(t,l,c,w,n,a,d){var p=t+(l&c|~l&w)+(n>>>0)+d;return(p<<a|p>>>32-a)+l},o._gg=function(t,l,c,w,n,a,d){var p=t+(l&w|c&~w)+(n>>>0)+d;return(p<<a|p>>>32-a)+l},o._hh=function(t,l,c,w,n,a,d){var p=t+(l^c^w)+(n>>>0)+d;return(p<<a|p>>>32-a)+l},o._ii=function(t,l,c,w,n,a,d){var p=t+(c^(l|~w))+(n>>>0)+d;return(p<<a|p>>>32-a)+l},o._blocksize=16,o._digestsize=16,ue.exports=function(t,l){if(t==null)throw new Error("Illegal argument "+t);var c=s.wordsToBytes(o(t,l));return l&&l.asBytes?c:l&&l.asString?i.bytesToString(c):s.bytesToHex(c)}}()),ue.exports}var he={exports:{}};/*! ***** BEGIN LICENSE BLOCK *****
 *!
 *! Copyright 2011-2012, 2014 Jean-Christophe Sirot <sirot@chelonix.com>
 *!
 *! This file is part of digest.js
 *!
 *! digest.js is free software: you can redistribute it and/or modify it under
 *! the terms of the GNU General Public License as published by the Free Software
 *! Foundation, either version 3 of the License, or (at your option) any later
 *! version.
 *!
 *! digest.js is distributed in the hope that it will be useful, but
 *! WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 *! or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
 *! more details.
 *!
 *! You should have received a copy of the GNU General Public License along with
 *! digest.js. If not, see http://www.gnu.org/licenses/.
 *!
 *! ***** END LICENSE BLOCK *****  */var Le;function pr(){return Le||(Le=1,function(s,r){(function(){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,i){var o,t=new Uint8Array(this);i===void 0&&(i=t.length);var l=new ArrayBuffer(i-e),c=new Uint8Array(l);for(o=0;o<c.length;o++)c[o]=t[o+e];return l})})(),function(e){function i(){}i.prototype.processBlock=function(a){var d=this.current[0],p=this.current[1],g=this.current[2],b=this.current[3],x=this.current[4],_=[a[0]<<24|a[1]<<16|a[2]<<8|a[3],a[4]<<24|a[5]<<16|a[6]<<8|a[7],a[8]<<24|a[9]<<16|a[10]<<8|a[11],a[12]<<24|a[13]<<16|a[14]<<8|a[15],a[16]<<24|a[17]<<16|a[18]<<8|a[19],a[20]<<24|a[21]<<16|a[22]<<8|a[23],a[24]<<24|a[25]<<16|a[26]<<8|a[27],a[28]<<24|a[29]<<16|a[30]<<8|a[31],a[32]<<24|a[33]<<16|a[34]<<8|a[35],a[36]<<24|a[37]<<16|a[38]<<8|a[39],a[40]<<24|a[41]<<16|a[42]<<8|a[43],a[44]<<24|a[45]<<16|a[46]<<8|a[47],a[48]<<24|a[49]<<16|a[50]<<8|a[51],a[52]<<24|a[53]<<16|a[54]<<8|a[55],a[56]<<24|a[57]<<16|a[58]<<8|a[59],a[60]<<24|a[61]<<16|a[62]<<8|a[63]],m,y;for(y=16;y<80;y++)_.push((_[y-3]^_[y-8]^_[y-14]^_[y-16])<<1|(_[y-3]^_[y-8]^_[y-14]^_[y-16])>>>31);for(y=0;y<80;y++)m=(d<<5|d>>>27)+x+_[y],y<20?m+=(p&g|~p&b)+1518500249|0:y<40?m+=(p^g^b)+1859775393|0:y<60?m+=(p&g|p&b|g&b)+2400959708|0:m+=(p^g^b)+3395469782|0,x=b,b=g,g=p<<30|p>>>2,p=d,d=m;this.current[0]+=d,this.current[1]+=p,this.current[2]+=g,this.current[3]+=b,this.current[4]+=x,this.currentLen+=64},i.prototype.doPadding=function(){var a=(this.inLen+this.currentLen)*8,d=0,p=a&4294967295,g=this.inLen<=55?55-this.inLen:119-this.inLen,b=new Uint8Array(new ArrayBuffer(g+1+8));return b[0]=128,b[b.length-1]=p&255,b[b.length-2]=p>>>8&255,b[b.length-3]=p>>>16&255,b[b.length-4]=p>>>24&255,b[b.length-5]=d&255,b[b.length-6]=d>>>8&255,b[b.length-7]=d>>>16&255,b[b.length-8]=d>>>24&255,b},i.prototype.getDigest=function(){var a=new Uint8Array(new ArrayBuffer(20));return a[3]=this.current[0]&255,a[2]=this.current[0]>>>8&255,a[1]=this.current[0]>>>16&255,a[0]=this.current[0]>>>24&255,a[7]=this.current[1]&255,a[6]=this.current[1]>>>8&255,a[5]=this.current[1]>>>16&255,a[4]=this.current[1]>>>24&255,a[11]=this.current[2]&255,a[10]=this.current[2]>>>8&255,a[9]=this.current[2]>>>16&255,a[8]=this.current[2]>>>24&255,a[15]=this.current[3]&255,a[14]=this.current[3]>>>8&255,a[13]=this.current[3]>>>16&255,a[12]=this.current[3]>>>24&255,a[19]=this.current[4]&255,a[18]=this.current[4]>>>8&255,a[17]=this.current[4]>>>16&255,a[16]=this.current[4]>>>24&255,a.buffer},i.prototype.reset=function(){this.currentLen=0,this.inLen=0,this.current=new Uint32Array(new ArrayBuffer(20)),this.current[0]=1732584193,this.current[1]=4023233417,this.current[2]=2562383102,this.current[3]=271733878,this.current[4]=3285377520},i.prototype.blockLen=64,i.prototype.digestLen=20;var o=function(a){var d=new ArrayBuffer(a.length),p=new Uint8Array(d),g;for(g=0;g<a.length;g++)p[g]=a.charCodeAt(g);return p},t=function(a){var d=new ArrayBuffer(1),p=new Uint8Array(d);return p[0]=a,p},l=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===String)return o(a);if(a.constructor===Number){if(a>255)throw"For more than one byte, use an array buffer";if(a<0)throw"Input value must be positive";return t(a)}else throw"Unsupported type"},c=function(a){var d=function(b){for(var x=b.length,_=0;x>0;){var m=this.blockLen-this.inLen;m>x&&(m=x);var y=b.subarray(_,_+m);this.inbuf.set(y,this.inLen),_+=m,x-=m,this.inLen+=m,this.inLen===this.blockLen&&(this.processBlock(this.inbuf),this.inLen=0)}},p=function(){var b=this.doPadding();this.update(b);var x=this.getDigest();return this.reset(),x},g=function(){if(!a)throw"Unsupported algorithm: "+a.toString();a.prototype.update=d,a.prototype.finalize=p;var b=new a;return b.inbuf=new Uint8Array(new ArrayBuffer(b.blockLen)),b.reset(),b}();return{update:function(b){g.update(l(b))},finalize:function(){return g.finalize()},digest:function(b){return g.update(l(b)),g.finalize()},reset:function(){g.reset()},digestLength:function(){return g.digestLen}}},w=function(a){var d=!1,p,g,b,x=function(){var u,f;if(!d){if(p===void 0)throw"MAC key is not defined";for(p.byteLength>64?f=new Uint8Array(a.digest(p)):f=new Uint8Array(p),g=new Uint8Array(new ArrayBuffer(64)),u=0;u<f.length;u++)g[u]=54^f[u];for(u=f.length;u<64;u++)g[u]=54;for(b=new Uint8Array(new ArrayBuffer(64)),u=0;u<f.length;u++)b[u]=92^f[u];for(u=f.length;u<64;u++)b[u]=92;d=!0,a.update(g.buffer)}},_=function(){d=!1,p=void 0,g=void 0,b=void 0,a.reset()},m=function(){var u=a.finalize();return a.reset(),a.update(b.buffer),a.update(u),u=a.finalize(),_(),u},y=function(u){p=u};return{setKey:function(u){y(l(u)),x()},update:function(u){a.update(u)},finalize:function(){return m()},mac:function(u){return this.update(u),this.finalize()},reset:function(){_()},hmacLength:function(){return a.digestLength()}}},n={SHA1:function(){return c(i)},HMAC_SHA1:function(){return w(c(i))}};s.exports&&(s.exports=n)}()}(he)),he.exports}var qe;function vr(){if(qe)return R;qe=1;var s=Ne();R.__esModule=!0,R.unix=t,R.blobToBuffer=l,R.assertOptions=c,R.getContentMd5=n,R.getCanonicalizedOSSHeaders=a,R.getCanonicalizedResource=d,R.getSignature=p;var r=s(dr()),e=s(Qe()),i=s(pr());function o(g){return g&&Object.prototype.toString.call(g)==="[object Date]"&&g.toString!=="Invalid Date"}function t(g){var b;return g&&(b=new Date(g)),o(b)||(b=new Date),Math.round(b.getTime()/1e3)}function l(g){return new Promise(function(b,x){var _=new FileReader;_.onload=function(){var m=new Uint8Array(_.result);b(m)},_.onerror=function(){x(_.error)},_.readAsArrayBuffer(g)})}function c(g){var b=g.accessKeyId,x=g.accessKeySecret,_=g.bucket,m=g.endpoint;if(!b)throw new Error("need accessKeyId");if(!x)throw new Error("need accessKeySecret");if(!_&&!m)throw new Error("need bucket or endpoint")}function w(g){for(var b=[],x=0;x<g.length;x+=2)b.push(parseInt(g[x]+g[x+1],16));return Uint8Array.from(b)}function n(g){var b=Array.prototype.slice.call(g,0),x=w((0,r.default)(b));return e.default.fromByteArray(x)}function a(g){var b="",x=Object.keys(g);return x=x.map(function(_){return _.toLowerCase()}),x.sort(),x.forEach(function(_){_.indexOf("x-oss-")===0&&(b+=_+":"+g[_]+`
`)}),b}function d(g,b,x){g===void 0&&(g=""),b===void 0&&(b="");var _="";g&&(_+="/"+g),b&&(b.charAt(0)!=="/"&&(_+="/"),_+=b);var m=""+_,y="?";if(x){var u=function(h,S){return h[0]>S[0]?1:h[0]<S[0]?-1:0},f=function(h){m+=y+h,x[h]&&(m+="="+x[h]),y="&"};Object.keys(x).sort(u).forEach(f)}return m}function p(g){g===void 0&&(g={});var b=g,x=b.type,_=x===void 0?"header":x,m=b.verb,y=m===void 0?"":m,u=b.contentMd5,f=u===void 0?"":u,v=b.expires,h=v===void 0?t()+3600:v,S=b.bucket,k=b.objectName,I=b.accessKeySecret,F=b.headers,z=F===void 0?{}:F,Z=b.subResource,E=z["x-oss-date"]||"",U=z["Content-Type"]||"",O=[y,f,U];_==="header"?O.push(E):O.push(h);var L=a(z),Xe=d(S,k,Z);O.push(""+L+Xe);var Je=O.join(`
`),Y=new i.default.HMAC_SHA1;Y.setKey(I),Y.update(Je);var We=new Uint8Array(Y.finalize()),Ze=e.default.fromByteArray(We);return Ze}return R}var Pe;function yr(){return Pe||(Pe=1,function(s){var r=Ne();s.__esModule=!0,s.default=void 0;var e=r(fr()),i=r(cr()),o=vr(),t=function(){function l(w){w===void 0&&(w={}),(0,o.assertOptions)(w),this.opts=(0,e.default)({region:"oss-cn-hangzhou",internal:!1,cname:!1,secure:!1,timeout:6e4},w);var n=this.opts,a=n.bucket,d=n.region,p=n.endpoint,g=n.internal;if(this.host="",p)this.host=p;else{var b=a;g&&(b+="-internal"),b+="."+d+".aliyuncs.com",this.host=b}}var c=l.prototype;return c.put=function(n,a,d){var p=this;return d===void 0&&(d={}),new Promise(function(g,b){(0,o.blobToBuffer)(a).then(function(x){var _=p.opts,m=_.accessKeyId,y=_.accessKeySecret,u=_.stsToken,f=_.bucket,v="PUT",h=(0,o.getContentMd5)(x),S=a.type,k={"Content-Md5":h,"Content-Type":S,"x-oss-date":new Date().toGMTString()};u&&(k["x-oss-security-token"]=u);var I=(0,o.getSignature)({verb:v,contentMd5:h,headers:k,bucket:f,objectName:n,accessKeyId:m,accessKeySecret:y});k.Authorization="OSS "+m+":"+I;var F=p.opts.secure?"https":"http",z=F+"://"+p.host+"/"+n;return(0,i.default)(z,{method:v,headers:k,data:a,timeout:p.opts.timeout,onprogress:d.onprogress})}).then(g).catch(b)})},c.putSymlink=function(n,a){var d=this.opts,p=d.accessKeyId,g=d.accessKeySecret,b=d.stsToken,x=d.bucket,_="PUT",m={"x-oss-date":new Date().toGMTString(),"x-oss-symlink-target":encodeURI(a)};b&&(m["x-oss-security-token"]=b);var y=(0,o.getSignature)({verb:_,headers:m,bucket:x,objectName:n,accessKeyId:p,accessKeySecret:g,subResource:{symlink:""}});m.Authorization="OSS "+p+":"+y;var u=this.opts.secure?"https":"http",f=u+"://"+this.host+"/"+n+"?symlink";return(0,i.default)(f,{method:_,headers:m,timeout:this.opts.timeout})},c.signatureUrl=function(n,a){a===void 0&&(a={});var d=a,p=d.expires,g=p===void 0?1800:p,b=d.method,x=d.process,_=d.response,m=this.opts,y=m.accessKeyId,u=m.accessKeySecret,f=m.stsToken,v=m.bucket,h={},S={};if(x){var k="x-oss-process";S[k]=x}_&&Object.keys(_).forEach(function(U){var O="response-"+U.toLowerCase();S[O]=_[U]}),Object.keys(a).forEach(function(U){var O=U.toLowerCase(),L=a[U];O.indexOf("x-oss-")===0?h[O]=L:O.indexOf("content-md5")===0||O.indexOf("content-type")===0?h[U]=L:O!=="expires"&&O!=="response"&&O!=="process"&&O!=="method"&&(S[O]=L)});var I=a["security-token"]||f;I&&(S["security-token"]=I);var F=(0,o.unix)()+g,z=(0,o.getSignature)({type:"url",verb:b||"GET",accessKeyId:y,accessKeySecret:u,bucket:v,objectName:n,headers:h,subResource:S,expires:F}),Z=this.opts.secure?"https":"http",E=Z+"://"+this.host+"/"+n;return E+="?OSSAccessKeyId="+y,E+="&Expires="+F,E+="&Signature="+encodeURIComponent(z),Object.keys(S).forEach(function(U){E+="&"+U+"="+encodeURIComponent(S[U])}),E},l}();s.default=t}(ie)),ie}var de,Me;function wr(){return Me||(Me=1,de=yr().default),de}export{wr as r,br as u};
