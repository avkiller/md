const s=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n$]))\1(?=[\s?!.,:？！。，：]|$)/,c=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n$]))\1/,u=/^(\${1,2})\n((?:\\[\s\S]|[^\\])+?)\n\1(?:\n|$)/;function o(n){return r=>{window.MathJax.texReset();const t=window.MathJax.tex2svg(r.text,{display:n}).firstChild,l=t.style["min-width"]||t.getAttribute("width");return t.removeAttribute("width"),t.style="max-width: 300vw !important;",t.style.width=l,t.style.display="initial",n?`<section style="text-align: center; overflow: auto;">${t.outerHTML}</section>`:`<span style="vertical-align: middle; line-height: 1;">${t.outerHTML}</span>`}}function d(n,r){const a=n&&n.nonStandard,t=a?c:s;return{name:"inlineKatex",level:"inline",start(l){let e,i=l;for(;i;){if(e=i.indexOf("$"),e===-1)return;if((a?e>-1:e===0||i.charAt(e-1)===" ")&&i.substring(e).match(t))return e;i=i.substring(e+1).replace(/^\$+/,"")}},tokenizer(l){const e=l.match(t);if(e)return{type:"inlineKatex",raw:e[0],text:e[2].trim(),displayMode:e[1].length===2}},renderer:r}}function x(n,r){return{name:"blockKatex",level:"block",tokenizer(a){const t=a.match(u);if(t)return{type:"blockKatex",raw:t[0],text:t[2].trim(),displayMode:t[1].length===2}},renderer:r}}function m(n={}){return{extensions:[d(n,o(!1)),x(n,o(!0))]}}export{m as MDKatex};
